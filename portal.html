<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JFWJFYZD6D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JFWJFYZD6D');
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teaching Success Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,600;9..144,800&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --ink:#2c3a52;
  --ink2:#1e2a3d;
  --blue:#4a6fa5;
  --gold:#f5c842;
  --bg:#eef1f7;
  --card:#ffffff;
  --border:#c8d0e0;
  --muted:#6b7a96;
  --ok:#1f7a4f;
  --warn:#b7791f;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Outfit',sans-serif;background:var(--bg);color:var(--ink);min-height:100vh}
button,input,select,textarea{font-family:'Outfit',sans-serif}

.nav{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;background:var(--ink);color:#fff;border-bottom:1px solid rgba(255,255,255,.14)}
.brand{display:flex;align-items:center;gap:.6rem;font-family:'Fraunces',serif;font-size:1.08rem;font-weight:800}
.mark{width:34px;height:34px;border-radius:8px;background:var(--gold);color:var(--ink);display:flex;align-items:center;justify-content:center;font-weight:900}
.nav a{color:rgba(255,255,255,.86);text-decoration:none;font-size:.9rem}

.wrap{max-width:1180px;margin:0 auto;padding:1rem}
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:1rem}
.hero{background:linear-gradient(135deg,var(--ink2),var(--blue));color:#fff;border:1px solid rgba(255,255,255,.16);margin-bottom:1rem}
.hero h1{font-family:'Fraunces',serif;font-size:1.8rem;margin-bottom:.4rem}
.hero p{opacity:.93;line-height:1.6}
.badge{display:inline-block;font-size:.73rem;font-weight:700;letter-spacing:.06em;text-transform:uppercase;padding:.2rem .5rem;border-radius:999px;background:rgba(255,255,255,.18);margin-bottom:.55rem}

.grid{display:grid;gap:1rem}
.grid.auth{grid-template-columns:1fr 1fr}
.grid.main{grid-template-columns:380px 1fr}

h2{font-family:'Fraunces',serif;font-size:1.25rem;margin-bottom:.7rem}
label{display:block;font-size:.78rem;font-weight:700;color:var(--muted);margin-bottom:.24rem;text-transform:uppercase;letter-spacing:.05em}
input,select,textarea{width:100%;padding:.66rem .78rem;border:2px solid var(--border);border-radius:8px;background:#fff;color:var(--ink)}
input:focus,select:focus,textarea:focus{outline:none;border-color:var(--blue)}
textarea{min-height:84px;resize:vertical}

.row{display:grid;gap:.7rem}
.actions{display:flex;gap:.6rem;flex-wrap:wrap}
.btn{border:none;border-radius:8px;padding:.62rem .95rem;cursor:pointer;font-weight:700}
.btn.dark{background:var(--ink);color:#fff}
.btn.blue{background:var(--blue);color:#fff}
.btn.ghost{background:#fff;border:2px solid var(--border);color:var(--ink)}
.btn.small{font-size:.82rem;padding:.45rem .65rem}

.muted{color:var(--muted);font-size:.9rem}
.msg{margin-top:.6rem;padding:.6rem .75rem;border-radius:8px;font-size:.88rem;display:none}
.msg.ok{background:#e8f7ef;color:var(--ok);border:1px solid #bfe5cf}
.msg.err{background:#fff0f0;color:#9b2c2c;border:1px solid #efc4c4}

.list{display:grid;gap:.7rem}
.item{border:1px solid var(--border);border-radius:10px;padding:.8rem;background:#fff}
.item h3{font-size:1rem;margin-bottom:.3rem}
.meta{display:flex;gap:.35rem;flex-wrap:wrap;margin-bottom:.45rem}
.tag{font-size:.72rem;border-radius:999px;padding:.14rem .45rem;background:#edf2fb;color:#233a62}
.tag.ok{background:#e8f7ef;color:var(--ok)}
.tag.warn{background:#fff8e8;color:var(--warn)}

.topline{display:flex;align-items:center;justify-content:space-between;gap:.6rem;margin-bottom:.75rem}
.tabs{display:flex;gap:.55rem;margin-bottom:1rem;flex-wrap:wrap}
.tab-btn{border:2px solid var(--border);background:#fff;color:var(--ink);border-radius:999px;padding:.45rem .85rem;font-weight:700;cursor:pointer}
.tab-btn.active{background:var(--ink);border-color:var(--ink);color:#fff}
.kpis{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:.7rem;margin-bottom:.8rem}
.kpi{border:1px solid var(--border);border-radius:10px;padding:.7rem;background:#fff}
.kpi b{font-family:'Fraunces',serif;font-size:1.35rem;display:block}

.hidden{display:none!important}

@media (max-width:980px){
  .grid.auth,.grid.main{grid-template-columns:1fr}
  .kpis{grid-template-columns:1fr}
}
</style>
</head>
<body>
  <header class="nav">
    <div class="brand"><div class="mark">TS</div>Teaching Success Portal</div>
    <a href="index.html">Back to Home</a>
  </header>

  <main class="wrap">
    <section class="card hero">
      <span class="badge">Supabase Portal</span>
      <h1>Real Login + Student Assignments</h1>
      <p>This is the real backend-powered portal scaffold. Tutors can assign work. Students can view and submit work. Data is stored in Supabase.</p>
    </section>

    <section id="config-warning" class="card" style="border-color:#efc4c4;background:#fff7f7;margin-bottom:1rem">
      <h2>Setup Required</h2>
      <p class="muted">Add your Supabase URL and anon key in <code>portal.js</code> before using this page.</p>
    </section>

    <section id="auth-view" class="grid auth">
      <div class="card">
        <h2>Sign In</h2>
        <div class="row">
          <div><label>Email</label><input id="signin-email" type="email" placeholder="you@example.com"></div>
          <div><label>Password</label><input id="signin-password" type="password" placeholder="********"></div>
          <div class="actions"><button class="btn dark" id="btn-signin" type="button">Sign In</button></div>
          <div class="msg" id="signin-msg"></div>
        </div>
      </div>

      <div class="card">
        <h2>Create Student/Parent Account</h2>
        <p class="muted" style="margin-bottom:.6rem">Use this for student or parent signup.</p>
        <div class="row">
          <div><label>Full Name</label><input id="signup-name" type="text" placeholder="Student Name"></div>
          <div><label>Email</label><input id="signup-email" type="email" placeholder="student@example.com"></div>
          <div><label>Password</label><input id="signup-password" type="password" placeholder="At least 8 characters"></div>
          <div>
            <label>Account Type</label>
            <select id="signup-role">
              <option value="student">Student</option>
              <option value="parent">Parent</option>
            </select>
          </div>
          <div>
            <label>Year Group</label>
            <select id="signup-year">
              <option value="">Prefer not to say</option>
              <option>Reception-Year 2</option>
              <option>Year 3-6</option>
              <option>Year 7-9</option>
              <option>GCSE</option>
              <option>A-Level</option>
              <option>11+</option>
            </select>
          </div>
          <div class="actions"><button class="btn blue" id="btn-signup" type="button">Create Account</button></div>
          <div class="msg" id="signup-msg"></div>
        </div>
      </div>
    </section>

    <section id="app-view" class="hidden">
      <div class="topline card" style="margin-bottom:1rem">
        <div>
          <h2 style="margin-bottom:.2rem">Welcome, <span id="who-name">...</span></h2>
          <p class="muted" id="who-role">Role: ...</p>
        </div>
        <div class="actions">
          <button class="btn ghost" id="btn-refresh" type="button">Refresh</button>
          <button class="btn dark" id="btn-signout" type="button">Sign Out</button>
        </div>
      </div>

      <div class="tabs">
        <button class="tab-btn active" id="btn-tab-dashboard" type="button">Assignments</button>
        <button class="tab-btn" id="btn-tab-reviews" type="button">Progress Reviews</button>
      </div>

      <section id="section-dashboard">
      <div id="tutor-view" class="grid main hidden">
        <aside class="card">
          <h2>Set Assignment</h2>
          <div class="row">
            <div>
              <label>Student</label>
              <select id="asg-student"></select>
            </div>
            <div>
              <label>Subject</label>
              <select id="asg-subject">
                <option>Maths</option>
                <option>English</option>
                <option>Science</option>
                <option>11+</option>
                <option>General</option>
              </select>
            </div>
            <div>
              <label>Exam Board</label>
              <select id="asg-exam-board">
                <option value="">Select exam board first</option>
                <option value="aqa">AQA</option>
                <option value="edexcel">Edexcel</option>
                <option value="ocr">OCR</option>
                <option value="wjec">WJEC</option>
                <option value="ccea">CCEA</option>
                <option value="none">No exam board / General</option>
              </select>
            </div>
            <div>
              <label>Curriculum Unit</label>
              <select id="asg-unit">
                <option value="">Select exam board first</option>
              </select>
            </div>
            <div>
              <label>Lesson</label>
              <select id="asg-lesson">
                <option value="">Select a unit first</option>
              </select>
            </div>
            <div><label>Title</label><input id="asg-title" type="text" placeholder="e.g. Algebra worksheet set"></div>
            <div><label>Due Date</label><input id="asg-due" type="date"></div>
            <div><label>Description / Instructions</label><textarea id="asg-desc" placeholder="What exactly should they complete?"></textarea></div>
            <div style="display:flex;align-items:center;gap:.55rem">
              <input id="asg-automark-enabled" type="checkbox" style="width:auto">
              <label for="asg-automark-enabled" style="margin:0;text-transform:none;letter-spacing:0;font-size:.92rem;color:var(--ink)">Enable auto-mark (for text submissions)</label>
            </div>
            <div><label>Auto-mark Keywords (comma separated)</label><input id="asg-automark-keywords" type="text" placeholder="e.g. photosynthesis, chlorophyll, glucose, oxygen"></div>
            <div><label>Target Word Count (optional)</label><input id="asg-automark-target-words" type="number" min="0" step="1" placeholder="e.g. 120"></div>
            <div><label>Resource Title</label><input id="asg-resource-title" type="text" placeholder="e.g. GCSE Algebra Worksheet"></div>
            <div><label>Resource Link</label><input id="asg-resource-url" type="url" placeholder="https://... (website, PDF, Drive link, etc.)"></div>
            <div><label>Attach File (private)</label><input id="asg-file" type="file"></div>
            <div class="actions"><button class="btn blue" id="btn-create-asg" type="button">Create Assignment</button></div>
            <div class="msg" id="asg-msg"></div>
          </div>
          <hr style="border:none;border-top:1px solid var(--border);margin:1rem 0">
          <h2 style="font-size:1.1rem">Link Parent to Student</h2>
          <div class="row">
            <div>
              <label>Parent</label>
              <select id="link-parent"></select>
            </div>
            <div>
              <label>Student</label>
              <select id="link-student"></select>
            </div>
            <div class="actions"><button class="btn dark" id="btn-link-parent" type="button">Create Parent Link</button></div>
            <div class="msg" id="link-msg"></div>
            <div id="parent-links-list" class="list"></div>
          </div>
        </aside>

        <section class="card">
          <h2>Tutor Dashboard</h2>
          <div class="kpis">
            <div class="kpi"><span class="muted">Active Assignments</span><b id="kpi-active">0</b></div>
            <div class="kpi"><span class="muted">Completed</span><b id="kpi-complete">0</b></div>
            <div class="kpi"><span class="muted">Student Submissions</span><b id="kpi-subs">0</b></div>
          </div>
          <div id="tutor-list" class="list"></div>
        </section>

      </div>

      <div id="student-view" class="card hidden">
        <h2>My Assignments</h2>
        <p class="muted" style="margin-bottom:.7rem">Submit notes/evidence when finished. This updates tutor tracking.</p>
        <div id="student-list" class="list"></div>
      </div>

      <div id="parent-view" class="card hidden">
        <h2>Parent Tracker</h2>
        <p class="muted" style="margin-bottom:.7rem">Read-only view of your linked child assignments, submissions, marks and feedback.</p>
        <div class="kpis">
          <div class="kpi"><span class="muted">Linked Students</span><b id="kpi-parent-students">0</b></div>
          <div class="kpi"><span class="muted">Total Assignments</span><b id="kpi-parent-total">0</b></div>
          <div class="kpi"><span class="muted">Completed</span><b id="kpi-parent-complete">0</b></div>
        </div>
        <div id="parent-linked-students" class="list" style="margin-bottom:.8rem"></div>
        <div id="parent-list" class="list"></div>
      </div>
      </section>

      <section id="section-reviews" class="hidden">
        <div id="tutor-reviews-view" class="grid main hidden">
          <aside class="card">
            <h2>Create Progress Review</h2>
            <div class="row">
              <div>
                <label>Student</label>
                <select id="review-student"></select>
              </div>
              <div>
                <label>Review Period</label>
                <input id="review-period" type="text" placeholder="e.g. Spring Term 1 / Feb Review">
              </div>
              <div>
                <label>Predicted Grade</label>
                <input id="review-predicted-grade" type="text" placeholder="e.g. 7 / B+ / A*">
              </div>
              <div>
                <label>Confidence (%)</label>
                <input id="review-confidence" type="number" min="0" max="100" step="1" placeholder="e.g. 72">
              </div>
              <div>
                <label>What They Are Doing Well</label>
                <textarea id="review-strengths" placeholder="Key strengths, wins, positive trends"></textarea>
              </div>
              <div>
                <label>Needs Extra Help With</label>
                <textarea id="review-support" placeholder="Gaps, weaker topics, intervention focus"></textarea>
              </div>
              <div>
                <label>Next Steps / Action Plan</label>
                <textarea id="review-next-steps" placeholder="What happens next and how progress will be measured"></textarea>
              </div>
              <div class="actions"><button class="btn blue" id="btn-save-review" type="button">Save Progress Review</button></div>
              <div class="msg" id="review-msg"></div>
            </div>
          </aside>

          <section class="card">
            <h2>Tutor Progress Reviews</h2>
            <div id="tutor-reviews-list" class="list"></div>
          </section>
        </div>

        <div id="student-reviews-view" class="card hidden">
          <h2>My Progress Reviews</h2>
          <p class="muted" style="margin-bottom:.7rem">Your tutorâ€™s predicted grade, strengths and improvement focus.</p>
          <div id="student-reviews-list" class="list"></div>
        </div>

        <div id="parent-reviews-view" class="card hidden">
          <h2>Parent Progress Reviews</h2>
          <p class="muted" style="margin-bottom:.7rem">Read-only progress snapshots for linked students.</p>
          <div id="parent-reviews-list" class="list"></div>
        </div>
      </section>
    </section>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="portal.js?v=20260221-1"></script>
</body>
</html>
